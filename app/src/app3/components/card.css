/* Card base and effects shared across app3 */
.card {
  position: relative;
  width: min(92vw, 400px);
  aspect-ratio: 200 / 279;
  background: #ffffff;
  border-radius: 14px;
  border: none;
  box-shadow: 0 14px 28px rgba(17,24,39,0.14), 0 6px 12px rgba(17,24,39,0.10);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  padding: 14px;
  color: #111827;
  isolation: isolate;
  cursor: pointer;
  --mx: .5; --my: .5; --glow: rgba(255,255,255,0.12);
  transform-origin: center; transform-style: preserve-3d;
  will-change: transform; transition: transform 120ms ease-out;
  touch-action: none; --ang-deg: 45deg; --int: .4;
}
.card::before {
  content: '';
  position: absolute; inset: 0; padding: 2px; border-radius: inherit;
  background: linear-gradient(135deg, #d1d5db, #9ca3af);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  pointer-events: none; z-index: 4;
}
.card::after {
  content: '';
  position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
  z-index: 3; opacity: 0; transition: opacity .2s ease;
  background:
    radial-gradient(300px circle at calc(var(--mx) * 100%) calc(var(--my) * 100%), var(--glow), transparent 60%),
    conic-gradient(from 0deg at calc(var(--mx) * 100%) calc(var(--my) * 100%), rgba(255,255,255,0), rgba(255,255,255,0.08) 15%, rgba(255,255,255,0) 30% 100%);
  mix-blend-mode: overlay;
}
.card.is-hovered::after { opacity: 1; }

.card-name {
  position: absolute; top: 12px; left: 12px; z-index: 5;
  display: inline-flex; align-items: center; justify-content: flex-start; gap: 8px;
  min-height: 40px; padding: 6px 12px; border-radius: 10px; width: auto; max-width: calc(100% - 24px);
  background: linear-gradient(180deg, rgba(16,18,28,0.75), rgba(16,18,28,0.45));
  color: #0f172a; font-size: 1.06rem; font-weight: 900; letter-spacing: .35px;
  text-shadow: 0 1px 0 rgba(255,255,255,0.35);
  -webkit-backdrop-filter: blur(3px); backdrop-filter: blur(3px);
  box-shadow: 0 10px 22px rgba(15,23,42,0.18);
  transform: skewX(-6deg);
}
.card-name .name-text {
  display: inline-block;
  padding: 2px 6px;
  transform: skewX(-6deg);
  background: linear-gradient(180deg, #fff7b1 0%, #ffd34d 40%, #ff9f1c 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow:
    1px 1px 0 #0b1220,
    -1px 1px 0 #0b1220,
    1px -1px 0 #0b1220,
    -1px -1px 0 #0b1220,
    0 3px 8px rgba(0,0,0,.25);
}
.card-name .name-badge {
  position: absolute; left: 10px; top: -10px; transform: translateY(-100%);
  display: none; align-items: center; gap: 6px; padding: 4px 10px;
  border-radius: 9999px; font-size: 11px; font-weight: 800; letter-spacing: .6px; text-transform: uppercase;
  background: rgba(255,255,255,0.92); color: #0b1220; box-shadow: 0 6px 14px rgba(15,23,42,0.18);
}
.card[data-rarity="ultra-rare"] .name-badge { display: inline-flex; }
.card-name::before {
  content: ''; position: absolute; inset: 0; border-radius: inherit; padding: 1px;
  background: linear-gradient(135deg, rgba(203,213,225,0.6), rgba(148,163,184,0.35));
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude; pointer-events: none;
}
.card-name::after {
  content: ''; position: absolute; inset: 0; border-radius: inherit;
  background: linear-gradient(110deg, rgba(255,255,255,0.22), rgba(255,255,255,0) 42%);
  mix-blend-mode: screen; opacity: .6; pointer-events: none;
}
.card[data-rarity="ultra-rare"] .card-name {
  background:
    linear-gradient(135deg, rgba(147,197,253,0.22), rgba(236,72,153,0.20), rgba(59,130,246,0.18)),
    linear-gradient(180deg, rgba(16,18,28,0.70), rgba(16,18,28,0.44));
  color: #0b1220; text-shadow: 0 1px 0 rgba(255,255,255,0.55);
}
.card[data-rarity="ultra-rare"] .card-name::before {
  background: linear-gradient(135deg, rgba(129,140,248,0.9), rgba(244,114,182,0.8), rgba(34,211,238,0.8));
}
.card[data-rarity="ultra-rare"] .card-name::after {
  background:
    linear-gradient(100deg, rgba(255,255,255,0.40), rgba(255,255,255,0) 40%),
    repeating-linear-gradient(135deg, rgba(255,255,255,0.10) 0 2px, rgba(255,255,255,0.0) 2px 6px);
  animation: nameSheen 4s linear infinite; opacity: .85;
}
@keyframes nameSheen { 0% { transform: translateX(-10%);} 50% { transform: translateX(10%);} 100% { transform: translateX(-10%);} }

.card-image { position: absolute; inset: 0; border-radius: inherit; overflow: hidden; z-index: 0; }
.card-image img { width: 100%; height: 100%; object-fit: cover; display: block; transform: translate3d(calc(var(--parx, 0) * 10px), calc(var(--pary, 0) * 10px), 0) scale(1.04); transition: transform .12s ease-out; }
.card-vignette { position: absolute; inset: 0; border-radius: inherit; pointer-events: none; z-index: 1; background: radial-gradient(80% 80% at 50% 50%, rgba(0,0,0,0) 50%, rgba(0,0,0,0.15) 100%); }

.card-effects {
  position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
  z-index: 2; opacity: 0; mix-blend-mode: overlay;
  background:
    linear-gradient(var(--ang-deg), rgba(255,255,255, calc(var(--int)*0.10)), rgba(255,255,255,0) 60%),
    repeating-linear-gradient(calc(var(--ang-deg) + 90deg), rgba(255,255,255,0.08) 0 2px, rgba(255,255,255,0.0) 2px 6px),
    linear-gradient(135deg, var(--fx-color-a, rgba(180,200,255,0.10)), var(--fx-color-b, rgba(200,255,220,0.10)), var(--fx-color-c, rgba(255,200,240,0.10)));
  background-size: 200% 200%, 140% 140%, 100% 100%;
  background-position: 50% 50%, 50% 50%, 50% 50%;
  filter: saturate(var(--fx-sat, 120%)) brightness(var(--fx-bright, 100%));
  transition: opacity .2s ease, background-position .2s ease;
}
.card.is-hovered .card-effects { opacity: .45; }

.card-rarity { position: relative; z-index: 5; font-size: 0.85rem; padding: 6px 12px; border-radius: 9999px; color: #fff; font-weight: 700; letter-spacing: .2px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: none !important; }
.common { background: #888; }
.rare { background: #16a34a; }
.super-rare { background: #f59e0b; }
.ultra-rare { background: #db2777; }
.holographic { background: linear-gradient(45deg, #f59e0b, #f43f5e, #6366f1, #22d3ee, #10b981); background-size: 400% 400%; animation: hologram 3s ease-in-out infinite; }
@keyframes hologram { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }

.card[data-rarity="common"]::before { background: linear-gradient(135deg, #e5e7eb, #cbd5e1); }
.card[data-rarity="common"] { --glow: rgba(148, 163, 184, 0.25); --fx-color-a: rgba(203,213,225,0.18); --fx-color-b: rgba(226,232,240,0.12); --fx-color-c: rgba(209,213,219,0.12); --fx-sat: 110%; }
.card[data-rarity="rare"]::before { background: linear-gradient(135deg, #34d399, #10b981); }
.card[data-rarity="rare"] { --glow: rgba(16, 185, 129, 0.28); --fx-color-a: rgba(16,185,129,0.22); --fx-color-b: rgba(45,212,191,0.18); --fx-color-c: rgba(74,222,128,0.16); }
.card[data-rarity="super-rare"]::before { background: linear-gradient(135deg, #f59e0b, #f97316); }
.card[data-rarity="super-rare"] { --glow: rgba(245, 158, 11, 0.28); --fx-color-a: rgba(245,158,11,0.22); --fx-color-b: rgba(251,146,60,0.18); --fx-color-c: rgba(253,186,116,0.16); }
.card[data-rarity="ultra-rare"]::before { background: linear-gradient(135deg, #818cf8, #f472b6, #22d3ee); }
.card[data-rarity="ultra-rare"] {
  --glow: rgba(147, 197, 253, 0.28);
  --fx-color-a: rgba(99,102,241,0.22);
  --fx-color-b: rgba(236,72,153,0.18);
  --fx-color-c: rgba(59,130,246,0.16);
  --fx-sat: 135%; --fx-bright: 108%;
}
.card[data-rarity="holographic"]::before { background: linear-gradient(135deg, #f59e0b, #f43f5e, #6366f1, #22d3ee, #10b981); background-size: 300% 300%; animation: holoBorder 6s linear infinite; }
.card[data-rarity="holographic"] { --glow: rgba(255, 255, 255, 0.32); --fx-color-a: rgba(245,158,11,0.22); --fx-color-b: rgba(99,102,241,0.22); --fx-color-c: rgba(16,185,129,0.22); --fx-sat: 140%; --fx-bright: 110%; }
@keyframes holoBorder { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
.card[data-rarity="holographic"] .card-effects { animation: holoShift 8s linear infinite; }
@keyframes holoShift { 0% { background-position: 0% 0%, 0% 0%, 50% 50%; } 50% { background-position: 100% 50%, 50% 100%, 50% 50%; } 100% { background-position: 0% 0%, 0% 0%, 50% 50%; } }

/* Ultra-Rare: Trainer Gallery Holofoil 風のパターン */
.card[data-rarity="ultra-rare"] .card-effects {
  background:
    radial-gradient(rgba(255,255,255,.35) 1px, transparent 1.6px) 0 0/6px 6px,
    radial-gradient(rgba(255,255,255,.22) 1px, transparent 1.6px) 3px 3px/8px 8px,
    linear-gradient(var(--ang-deg), rgba(255,255,255, calc(var(--int)*0.18)), rgba(255,255,255,0) 60%),
    linear-gradient(135deg, rgba(99,102,241,0.20), rgba(236,72,153,0.16), rgba(59,130,246,0.16));
  mix-blend-mode: overlay;
  background-size: 240px 240px, 280px 280px, 200% 200%, 100% 100%;
  animation: tgShift 12s linear infinite;
  filter: saturate(var(--fx-sat, 135%)) brightness(var(--fx-bright, 108%));
}
@keyframes tgShift {
  0% { background-position: 0% 0%, 0% 0%, 50% 50%, 50% 50%; }
  50% { background-position: 100% 50%, 50% 100%, 60% 40%, 50% 50%; }
  100% { background-position: 0% 0%, 0% 0%, 50% 50%, 50% 50%; }
}
